CKEDITOR.plugins.add("editextension",{init:function(c){var b=c.config.editextension,d=b.Id;c.addCommand(d,{exec:function(a){eval(b.Command)}});c.contextMenu&&(c.addMenuGroup("extension"),c.addMenuItem("editextension",{label:b.Text,icon:b.IconSrc||this.path+"icons/tools"+(CKEDITOR.env.hidpi?"32.png":"16.png"),command:d,group:"extension"}),c.contextMenu.addListener(function(a){a&&(a=a.getAscendant("img",!0));if(a&&!a.isReadOnly()&&!a.data("cke-realelement")&&null!=a.getAttribute("id")&&0==a.getAttribute("id").indexOf("extension:")){var d=
TextEditorManager.getExtensionIdFromIdString(a.getAttribute("id"));if(d==TextEditorManager.commonSettings.constants.oembedExtensionId)return null;a=a.getAttribute("editReference");var e=null!=a&&0<a.length;c.getMenuItem("editextension").label=e?b.EditText:b.Text;b.Command=b.Command.replace("{editorId}",c.name);b.Command=b.Command.replace(new RegExp(/ExtensionId=\S*?&/),"ExtensionId="+d+"&");b.Command=b.Command.setQueryStringParameter("EditReference",a);return{editextension:CKEDITOR.TRISTATE_OFF}}return null}))}});
